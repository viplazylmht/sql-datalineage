%%{init: {"flowchart": {"defaultRenderer": "elk"}} }%%
graph LR
subgraph 1197767799824 ["Table: catalog.schema1.customer AS customer"]
1197767797712["id"]
1197767797232["name"]
1197767559552["phone"]
1197764803520["address"]
1197767796992["location"]
end

subgraph 1197767799872 ["CTE: cte1 AS t1"]
1197767799776["id"]
1197767798624["name"]
1197767572656["phone"]
1197767800256["address"]
end
1197767797712 --> 1197767799776
1197767797232 --> 1197767798624
1197767559552 --> 1197767572656
1197764803520 --> 1197767800256

subgraph 1197767800064 ["Table: catalog.schema1.user_demographics AS user_demographics"]
1197767799632["id"]
1197767800208["name"]
1197767800400["age"]
1197767799968["phone"]
1197767800352["customer_job"]
1197767800496["parent"]
end

subgraph 1197767797568 ["CTE: tmp_cte AS tmp_cte"]
1197767799248["id"]
1197767800448["name"]
1197767796224["age"]
1197767798192["phone"]
1197767800160["customer_job"]
end
1197767799632 --> 1197767799248
1197767800208 --> 1197767800448
1197767800400 --> 1197767796224
1197767799968 --> 1197767798192
1197767800352 --> 1197767800160

subgraph 1197767799584 ["CTE: cte2 AS t2"]
1197767800112["id"]
1197767800304["name"]
1197767800640["age"]
1197767797328["phone"]
1197767800592["job"]
end
1197767799248 --> 1197767800112
1197767800448 --> 1197767800304
1197767796224 --> 1197767800640
1197767798192 --> 1197767797328
1197767800160 --> 1197767800592

subgraph 1197768337952 ["Table: catalog.schema1.customer AS customer"]
1197768337376["id"]
1197768338240["name"]
1197768338816["phone"]
1197768338720["address"]
1197768338624["location"]
end

subgraph 1197768337520 ["Select: Scalar subquery"]
1197768337184["max_id"]
end
1197768337184_exp[["MAX(customer.id)"]] ----- 1197768337184
1197768337376 --> 1197768337184

subgraph 1197767799536 ["Subquery: _q_0"]
1197767800688["id"]
1197767799440["name"]
1197767800928["phone"]
1197767798048["address"]
1197767800976["full_name"]
1197767800784["max_age"]
1197767802512["maxid"]
end
1197767799776 --> 1197767800688
1197767798624 --> 1197767799440
1197767572656 --> 1197767800928
1197767800256 --> 1197767798048
1197767800976_exp[["CONCAT(t1.name, t2.name)"]] ----- 1197767800976
1197767798624 --> 1197767800976
1197767800304 --> 1197767800976
1197767800784_exp[["MAX(t2.age)"]] ----- 1197767800784
1197767800640 --> 1197767800784
1197768337520 --> 1197767802512

subgraph 1197765281024 ["Select: _output_"]
1197767796512["id"]
1197767801840["name"]
1197768332432["phone"]
1197767801360["address"]
1197757964336["full_name"]
1197757963904["max_age"]
1197763516928["maxid"]
end
1197767800688 --> 1197767796512
1197767799440 --> 1197767801840
1197767800928 --> 1197768332432
1197767798048 --> 1197767801360
1197767800976 --> 1197757964336
1197767800784 --> 1197757963904
1197767802512 --> 1197763516928
