%%{init: {"flowchart": {"defaultRenderer": "elk"}} }%%
graph LR
subgraph 4268966526438662112 ["Table: catalog.schema1.customer AS customer"]
5236878093661038685["id"]
1435282661164111962["name"]
10887784210242626249["phone"]
2656738007850556460["address"]
10286006258372629408["location"]
end

subgraph 4507473409285345051 ["CTE: cte1 AS t1"]
10272884136923205013["id"]
17245649110553671778["name"]
5308419161799639384["phone"]
6803760761198231998["address"]
end
5236878093661038685 --> 10272884136923205013
1435282661164111962 --> 17245649110553671778
10887784210242626249 --> 5308419161799639384
2656738007850556460 --> 6803760761198231998

subgraph 17772230212068505152 ["Table: catalog.schema1.user_demographics AS user_demographics"]
18223017551442279303["id"]
6501088148451127731["name"]
4093474326762129000["age"]
6636782535431838226["phone"]
1522593651987828411["customer_job"]
9708519275690747857["parent"]
end

subgraph 106520006120493841 ["CTE: tmp_cte AS tmp_cte"]
1022664449863864144["id"]
2760653953610209330["name"]
17466192704016539432["age"]
9016933615603744964["phone"]
17491947744639933371["customer_job"]
end
18223017551442279303 --> 1022664449863864144
6501088148451127731 --> 2760653953610209330
4093474326762129000 --> 17466192704016539432
6636782535431838226 --> 9016933615603744964
1522593651987828411 --> 17491947744639933371

subgraph 1333079788050548230 ["CTE: cte2 AS t2"]
9729409177089451365["id"]
7151062507654067874["name"]
2004504822717528303["age"]
1007747146096968484["phone"]
16001638110751197873["job"]
end
1022664449863864144 --> 9729409177089451365
2760653953610209330 --> 7151062507654067874
17466192704016539432 --> 2004504822717528303
9016933615603744964 --> 1007747146096968484
17491947744639933371 --> 16001638110751197873

subgraph 4268966526438662112 ["Table: catalog.schema1.customer AS customer"]
5236878093661038685["id"]
1435282661164111962["name"]
10887784210242626249["phone"]
2656738007850556460["address"]
10286006258372629408["location"]
end

subgraph 14630080389240195727 ["Select: Scalar subquery"]
10086943775435701908["max_id"]
end
10086943775435701908_exp[["MAX(customer.id)"]] ----- 10086943775435701908
5236878093661038685 --> 10086943775435701908

subgraph 1480411460825200843 ["Subquery: _q_0"]
14369315527220485175["id"]
7813313169203600597["name"]
1264840354409610512["phone"]
16994287781987127459["address"]
6334899608225064007["full_name"]
11691112165929104308["max_age"]
7879620629537867491["maxid"]
end
10272884136923205013 --> 14369315527220485175
17245649110553671778 --> 7813313169203600597
5308419161799639384 --> 1264840354409610512
6803760761198231998 --> 16994287781987127459
6334899608225064007_exp[["CONCAT(t1.name, t2.name)"]] ----- 6334899608225064007
17245649110553671778 --> 6334899608225064007
7151062507654067874 --> 6334899608225064007
11691112165929104308_exp[["MAX(t2.age)"]] ----- 11691112165929104308
2004504822717528303 --> 11691112165929104308
14630080389240195727 --> 7879620629537867491

subgraph 7330780366353446715 ["Select: _output_"]
2369324186034535932["id"]
7049583450599355667["name"]
4345468222728090012["phone"]
2763424457680594458["address"]
13043898860491568983["full_name"]
8760731111657453880["max_age"]
5274805440047679075["maxid"]
end
14369315527220485175 --> 2369324186034535932
7813313169203600597 --> 7049583450599355667
1264840354409610512 --> 4345468222728090012
16994287781987127459 --> 2763424457680594458
6334899608225064007 --> 13043898860491568983
11691112165929104308 --> 8760731111657453880
7879620629537867491 --> 5274805440047679075
